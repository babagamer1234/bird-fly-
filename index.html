<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Flappy Game</title>
<style>
  :root{--bg:#7ec0ee}
  html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
  #gameWrap{display:flex;flex-direction:column;align-items:center;gap:8px;padding:12px;background:linear-gradient(#aee,#7ec0ee);min-height:100vh;position:relative}
  canvas{background:linear-gradient(#87ceeb, #5fb1e6);border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,0.15)}
  .controls{display:flex;gap:8px;align-items:center}
  button{background:white;border:0;padding:8px 12px;border-radius:8px;box-shadow:0 6px rgba(0,0,0,0.08);cursor:pointer}
  .hint{font-size:13px;color:#045}
  .status{display:flex;gap:12px;align-items:center}
  .score{font-weight:700;color:#034}
  .footer{font-size:12px;color:#024;margin-top:8px}
  #gameOverBtn{display:none;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);padding:14px 26px;border-radius:12px;font-size:22px;cursor:pointer;z-index:50;background:#ff3b3b;color:white;box-shadow:0 6px 20px rgba(0,0,0,0.25);border:none}
</style>
</head>
<body>
  <div id="gameWrap">
    <h1 style="margin:0">Flappy Bird — Ready for GitHub</h1>
    <canvas id="game" width="420" height="600"></canvas>

    <button id="gameOverBtn">Game Over — Restart</button>

    <div class="controls">
      <button id="startBtn">Start / Restart</button>
      <button id="muteBtn">Mute</button>
      <div class="status">
        <div class="score">Score: <span id="score">0</span></div>
        <div class="hint">Tap / Space to flap — click canvas to focus</div>
      </div>
    </div>

    <div class="footer">To publish: push this file as <code>index.html</code> to a GitHub repo and enable Pages.</div>
  </div>

  <!-- Audio file included in repo: videoplayback.m4a -->
  <audio id="bgm" src="./videoplayback.m4a" preload="auto"></audio>

<script>
// Image assets (already hosted)
const BIRD_IMG = "https://i.ibb.co/PvhB0NQ9/Screenshot-2025-11-30-165334.png";
const PILLAR_IMG = "https://i.ibb.co/bjPywQps/Screenshot-2025-11-30-165710.png";

const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
const W = canvas.width, H = canvas.height;

let frames = 0;
let score = 0;
let pipes = [];
let gameOver = false;
let running = false;

const bird = { x: 60, y: H/2, w: 48, h: 34, vel: 0, gravity: 0.45, jump: -8 };

const imgBird = new Image(); imgBird.src = BIRD_IMG;
const imgPipe = new Image(); imgPipe.src = PILLAR_IMG;

const startBtn = document.getElementById('startBtn');
const muteBtn = document.getElementById('muteBtn');
const scoreEl = document.getElementById('score');
const bgm = document.getElementById('bgm');
const gameOverBtn = document.getElementById('gameOverBtn');
let muted = false;

startBtn.onclick = () => { resetGame(); startGame(); };
gameOverBtn.onclick = () => { resetGame(); startGame(); };
muteBtn.onclick = () => { muted = !muted; bgm.muted = muted; muteBtn.textContent = muted ? 'Unmute' : 'Mute'; };

window.addEventListener('keydown', e => { if (e.code === 'Space') flap(); });
canvas.addEventListener('pointerdown', e => flap());

function flap(){ if(!running) startGame(); bird.vel = bird.jump; try { bgm.play().catch(()=>{}); } catch(e){} }

function startGame(){ if(running) return; running = true; gameOver = false; try { bgm.play().catch(()=>{}); } catch(e){} }

function resetGame(){
  frames = 0; score = 0; pipes = []; bird.y = H/2; bird.vel = 0; gameOver = false; running = false;
  bgm.currentTime = 0;
  scoreEl.textContent = score;
  gameOverBtn.style.display = 'none';
}

function spawnPipe(){
  const gap = 140;
  const minTop = 60;
  const maxTop = H - gap - 120;
  const top = Math.max(minTop, Math.random()*(maxTop-minTop)+minTop);
  pipes.push({x: W + 20, top, width: 80, passed:false});
}

function rectsOverlap(x1,y1,w1,h1,x2,y2,w2,h2){
  return x1 < x2 + w2 && x1 + w1 > x2 && y1 < y2 + h2 && y1 + h1 > y2;
}

function collides(pipe){
  const bx = bird.x, by = bird.y, bw = bird.w, bh = bird.h;
  const tx = pipe.x, ty = 0, tw = pipe.width, th = pipe.top;
  const bxp = pipe.x, byp = pipe.top + 140, bwp = pipe.width, bhp = H - (pipe.top + 140);
  if(rectsOverlap(bx,by,bw,bh, tx,ty,tw,th)) return true;
  if(rectsOverlap(bx,by,bw,bh, bxp,byp,bwp,bhp)) return true;
  return false;
}

function update(){
  if(!running) return;
  frames++;
  if(frames % 90 === 0) spawnPipe();

  for(let i = pipes.length-1; i>=0; i--){
    pipes[i].x -= 2.8 + Math.min(2.5, frames/2000);
    if(!pipes[i].passed && pipes[i].x + pipes[i].width < bird.x){ pipes[i].passed = true; score++; scoreEl.textContent = score; }
    if(pipes[i].x + pipes[i].width < -50) pipes.splice(i,1);
    if(collides(pipes[i])){ gameOver = true; running = false; bgm.pause(); gameOverBtn.style.display = 'block'; }
  }

  bird.vel += bird.gravity;
  bird.y += bird.vel;
  if(bird.y + bird.h > H - 10){ bird.y = H - 10 - bird.h; bird.vel = 0; running = false; gameOver = true; bgm.pause(); gameOverBtn.style.display = 'block'; }
  if(bird.y < 0){ bird.y = 0; bird.vel = 0; }
}

function draw(){
  ctx.clearRect(0,0,W,H);
  const g = ctx.createLinearGradient(0,0,0,H);
  g.addColorStop(0,'#87ceeb'); g.addColorStop(1,'#5fb1e6');
  ctx.fillStyle = g; ctx.fillRect(0,0,W,H);

  for(const p of pipes){
    if(imgPipe.complete && imgPipe.width>0){
      ctx.drawImage(imgPipe, 0, 0, imgPipe.width, imgPipe.height, p.x, p.top - imgPipe.height, p.width, imgPipe.height);
      ctx.drawImage(imgPipe, 0, 0, imgPipe.width, imgPipe.height, p.x, p.top + 140, p.width, imgPipe.height);
    } else {
      ctx.fillStyle='green'; ctx.fillRect(p.x,0,p.width,p.top);
      ctx.fillRect(p.x,p.top+140,p.width,H-(p.top+140));
    }
  }

  if(imgBird.complete && imgBird.width>0){
    ctx.drawImage(imgBird, bird.x, bird.y, bird.w, bird.h);
  } else {
    ctx.fillStyle='yellow'; ctx.fillRect(bird.x, bird.y, bird.w, bird.h);
  }

  ctx.fillStyle = '#022'; ctx.font = '28px system-ui'; ctx.fillText('Score: '+score, 12, 34);

  if(gameOver){
    ctx.fillStyle = 'rgba(0,0,0,0.45)'; ctx.fillRect(0, H/2 - 60, W, 120);
    ctx.fillStyle = '#fff'; ctx.font = '36px system-ui'; ctx.textAlign = 'center'; ctx.fillText('Game Over', W/2, H/2 - 10);
    ctx.font = '18px system-ui'; ctx.fillText('Click Restart', W/2, H/2 + 20);
    ctx.textAlign = 'left';
  }
}

function loop(){ update(); draw(); requestAnimationFrame(loop); }
loop();

// Try to start audio on first load; browsers often block autoplay until user interacts
setTimeout(()=>{ bgm.play().catch(()=>{}); }, 500);
</script>
</body>
</html>
