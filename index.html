<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Flappy Bird Game</title>
<style>
  * { margin:0; padding:0; box-sizing:border-box; }
  body { display:flex; justify-content:center; align-items:center; height:100vh; background:#70c5ce; position:relative; }
  canvas { background:#70c5ce; display:block; }
  #restartBtn {
    display:none;
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%, -50%);
    padding:15px 30px;
    font-size:20px;
    cursor:pointer;
    border:none;
    border-radius:10px;
    background:#ffcc00;
    color:#000;
  }
</style>
</head>
<body>
<canvas id="gameCanvas" width="400" height="600"></canvas>
<button id="restartBtn">Restart</button>

<!-- Background music -->
<audio id="bgMusic" src="https://drive.google.com/file/d/1Wn-og0oHxepCXUsU61Wi_noQjMTgVydY/view?usp=sharing" loop></audio>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const bgMusic = document.getElementById('bgMusic');

let birdImg = new Image();
birdImg.src = 'https://ibb.co/Zj13FDV';

let pipeImg = new Image();
pipeImg.src = 'https://ibb.co/PKtvTXQ';

// Game variables
let bird = { x:50, y:200, width:40, height:30, gravity:0.6, lift:-10, velocity:0 };
let pipes = [];
let frame = 0;
let score = 0;
const gap = 150;
let gameOver = false;

const restartBtn = document.getElementById('restartBtn');

// Controls
function flap() { if(!gameOver) bird.velocity = bird.lift; }
document.addEventListener('keydown', flap);
document.addEventListener('touchstart', flap);

// Play music on first interaction
document.addEventListener('click', () => { bgMusic.play(); }, { once: true });
document.addEventListener('touchstart', () => { bgMusic.play(); }, { once: true });

// Restart button
restartBtn.addEventListener('click', () => {
  restartBtn.style.display = 'none';
  resetGame();
  update();
});

function drawBird(){ ctx.drawImage(birdImg, bird.x, bird.y, bird.width, bird.height); }

function drawPipes(){
  for(let i=0;i<pipes.length;i++){
    let p = pipes[i];
    ctx.drawImage(pipeImg, p.x, 0, p.width, p.top);
    ctx.drawImage(pipeImg, p.x, canvas.height - p.bottom, p.width, p.bottom);
  }
}

function updatePipes(){
  if(frame % 90 === 0){
    let topHeight = Math.random() * (canvas.height - gap - 100) + 50;
    let bottomHeight = canvas.height - gap - topHeight;
    pipes.push({ x:canvas.width, width:50, top:topHeight, bottom:bottomHeight });
  }

  for(let i=0;i<pipes.length;i++){
    pipes[i].x -= 2;

    if(bird.x < pipes[i].x + pipes[i].width &&
       bird.x + bird.width > pipes[i].x &&
       (bird.y < pipes[i].top || bird.y + bird.height > canvas.height - pipes[i].bottom)){
      endGame();
    }

    if(pipes[i].x + pipes[i].width === bird.x) score++;
  }

  pipes = pipes.filter(p => p.x + p.width > 0);
}

function endGame(){ gameOver = true; restartBtn.style.display='block'; }

function resetGame(){
  bird.y = 200; bird.velocity=0; pipes=[]; score=0; frame=0; gameOver=false;
}

function update(){
  frame++;
  ctx.clearRect(0,0,canvas.width,canvas.height);

  bird.velocity += bird.gravity;
  bird.y += bird.velocity;

  if(bird.y + bird.height > canvas.height || bird.y < 0) endGame();

  drawBird();
  if(!gameOver) updatePipes();
  drawPipes();

  ctx.fillStyle="white";
  ctx.font="30px Arial";
  ctx.fillText("Score: " + score,10,40);

  if(score >= 10){
    ctx.fillStyle="yellow";
    ctx.font="40px Arial";
    ctx.fillText("You Win!",canvas.width/2-80,canvas.height/2);
    gameOver=true;
    restartBtn.style.display='block';
    return;
  }

  if(!gameOver) requestAnimationFrame(update);
}

// Start game after images load
birdImg.onload = () => { pipeImg.onload = () => { update(); } }
</script>
</body>
</html>
